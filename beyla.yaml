discovery:
  # Make discovery less resource intensive
  poll_interval: 30s      # Check for new processes every 30s
  min_process_age: 30s    # Only instrument processes older than 30s

  instrument:
    - open_ports: "1-65535"

  exclude_instrument:
    - open_ports: "33000"
    - open_ports: "34320"
    - exe_path: ".*/vector$"
    - exe_path: ".*/fluentd$"
    - exe_path: ".*/fluentbit$"
    - exe_path: ".*/cluster-agent$"

  exclude_otel_instrumented_services: true

otel_metrics_export:

prometheus_export:
  port: 0

network:
  cache_max_flows: 5000
  enable: false

otel_traces_export:
  # Required to create trace spans for database operations
  instrumentations:
    - "*"

ebpf:
  context_propagation: all
  track_request_headers: true

  # Without this, Beyla only detects MySQL/PostgreSQL binary protocols
  # Enable to capture SQL from ORMs, connection poolers, or other databases
  heuristic_sql_detect: true

  # Required for tracking prepared statements which use numeric IDs instead of SQL text
  mysql_prepared_statements_cache_size: 100

  # Without adequate buffer size, long SQL queries get truncated
  # 4096 bytes captures most queries without excessive memory usage
  buffer_sizes:
    mysql: 4096
    postgres: 4096

attributes:
  select:
    traces:
      include:
        # Get full database query
        - "db.query.text"
